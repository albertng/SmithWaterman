// Simple Smith-Waterman Example
/* Constant match, mismatch, gap scoring parameters
 */

alphabet = {A, C, G, T};

signed<10> H[][];

cell() {
  signed<10> substitute = 2;
  if (query_char != ref_char) {
    substitute = -2;
  }
  H[row][col] = max(0,
                    H[row-1][col-1] + substitute,
                    H[row-1][col] - 1,
                    H[row][col-1] -1);
}

condition(signed<10> threshold) {
  if (H[row][col] >= threshold) {
    report();
  }
}
